# 导入导出与数据同步功能

## 1. 导入功能

### 1.1 CSV和Excel导入
- 智能字段映射：自动将文件列映射到系统字段
- 支持标准字段和自定义字段
- 导入过程中验证数据格式
- 重复数据检测和处理

### 1.2 导入验证机制
- 文件格式验证
- 数据完整性检查
- 业务规则验证（如必填字段、数据类型等）
- 导入前预览功能

### 1.3 导入进度追踪
- 后台处理大文件
- 实时进度显示
- 成功/失败计数
- 详细的错误报告包括行号和错误详情

### 1.4 模板生成
- 自动生成导入模板包含所有当前字段
- 支持CSV和Excel格式
- 包含字段说明和格式要求

## 2. 导出功能

### 2.1 多格式导出
- CSV格式导出
- Excel格式导出
- 支持自定义字段导出
- 选择性字段导出

### 2.2 导出条件
- 基于当前筛选条件导出
- 自定义字段选择
- 数据格式化选项

### 2.3 导出模板
- 预定义导出模板
- 用户自定义模板
- 快速导出常用字段组合

## 3. 数据同步功能

### 3.1 同步包创建
- 创建包含所有企业和元数据的同步包
- 包含版本信息和记录计数
- SHA256哈希验证完整性

### 3.2 同步包导入
- 导入同步包合并到当前数据
- 多种冲突解决策略：
  - 覆盖：用导入数据替换现有数据
  - 保持现有：保留现有数据
  - 合并：结合新旧数据
- 导入前完整性验证

### 3.3 数据共享
- 导出可移植格式用于分享
- 从共享文件导入数据
- 文件大小限制和安全验证

### 3.4 同步状态监控
- 同步历史和状态
- 待处理同步统计
- 错误和警告报告

## 4. 离线协同高级方案 (.eap)
关于面向小组成员的、基于 AirDrop 的趣味化离线同步设计，请参考：[离线数据同步与协作方案](./OFFLINE_SYNC_DESIGN.md)。

## 5. 技术实现细节

### 4.1 文件处理
- 使用Papa Parse处理CSV文件
- 使用Excel4node处理Excel文件
- 支持大文件分块处理

### 4.2 数据验证
- 动态属性验证
- 字段类型验证
- 业务规则验证

### 4.3 冲突解决
- 智能重复检测
- 多策略冲突解决
- 用户可配置解决规则

### 4.4 安全措施
- 文件上传验证
- 数据完整性检查
- 哈希验证确保数据未被篡改

## 5. API端点

### 5.1 导入端点
- /api/import/enterprises - 企业导入
- /api/import/template - 生成导入模板
- /api/import/status/:jobId - 导入状态查询

### 5.2 导出端点
- /api/export/enterprises - 企业导出
- /api/export/templates - 导出模板
- /api/export/download/:fileId - 下载导出文件

### 5.3 同步端点
- /api/sync/create-package - 创建同步包
- /api/sync/import-package - 导入同步包
- /api/sync/status - 同步状态
- /api/sync/validate-package - 包验证

这些功能确保了企业数据在不同环境和计算机之间可以高效、安全地传输和同步，同时保持数据的完整性和一致性。