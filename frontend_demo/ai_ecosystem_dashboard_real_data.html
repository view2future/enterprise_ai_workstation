<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI技术生态仪表盘 - 真实数据</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8fafc;
        }
        
        /* Neubrutalism style enhancements */
        .neubrutal-card {
            border: 4px solid #1e293b;
            box-shadow: 6px 6px 0 0 #1e293b;
            background-color: white;
        }
        
        .neubrutal-button {
            border: 3px solid #1e293b;
            box-shadow: 4px 4px 0 0 #1e293b;
            background-color: #1e293b;
            color: white;
            font-weight: 700;
        }
        
        .neubrutal-button:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 0 #1e293b;
        }
        
        .neubrutal-input {
            border: 3px solid #1e293b;
            box-shadow: 4px 4px 0 0 #1e293b;
        }
        
        .highlight-card {
            border: 4px solid #3b82f6;
            box-shadow: 6px 6px 0 0 #3b82f6;
        }
        
        .ai-card {
            border: 4px solid #8b5cf6;
            box-shadow: 6px 6px 0 0 #8b5cf6;
        }
        
        .cooperation-card {
            border: 4px solid #10b981;
            box-shadow: 6px 6px 0 0 #10b981;
        }
        
        .sidebar {
            background: #1e293b;
            border-right: 4px solid #334155;
        }
        
        .main-header {
            border-bottom: 4px solid #cbd5e1;
        }
        
        .stat-number {
            font-weight: 900;
            font-size: 2.5rem;
        }
        
        .chart-placeholder {
            background: repeating-linear-gradient(
                45deg,
                #f1f5f9,
                #f1f5f9 10px,
                #e2e8f0 10px,
                #e2e8f0 20px
            );
        }
        
        .cooperation-level {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 700;
        }
        
        .level-1 { background-color: #fef3c7; color: #d97706; }
        .level-2 { background-color: #d1fae5; color: #065f46; }
        .level-3 { background-color: #dbeafe; color: #1e40af; }
        .level-4 { background-color: #c7d2fe; color: #5b21b6; }
        
        .ai-maturity {
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 700;
        }
        
        .maturity-exploring { background-color: #fee2e2; color: #b91c1c; }
        .maturity-piloting { background-color: #fef3c7; color: #d97706; }
        .maturity-deploying { background-color: #d1fae5; color: #065f46; }
        .maturity-scaling { background-color: #bfdbfe; color: #1e40af; }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        // Fetch data from API
        async function fetchAIData() {
            try {
                const response = await fetch('http://localhost:3001/api/ai-ecosystem-stats');
                if (response.ok) {
                    const result = await response.json();
                    return result.data;
                } else {
                    console.error('API请求失败:', response.status);
                    // Return default data in case of API failure
                    return {
                        totalEnterprises: 0,
                        aiAdopters: 0,
                        baiduAICoverage: 0,
                        deepCooperation: 0,
                        monthlyGrowth: '+0%',
                        aiAdoptionRate: '0%',
                        baiduAIUsageRate: '0%',
                        deepCooperationRate: '0%',

                        industryDistribution: [],
                        scenarioDistribution: [],
                        priorityDistribution: [],
                        deepCooperationEnterprises: [],
                        recentActivities: [],
                        trendData: []
                    };
                }
            } catch (error) {
                console.error('获取数据失败:', error);
                // Return default data in case of network error
                return {
                    totalEnterprises: 0,
                    aiAdopters: 0,
                    baiduAICoverage: 0,
                    deepCooperation: 0,
                    monthlyGrowth: '+0%',
                    aiAdoptionRate: '0%',
                    baiduAIUsageRate: '0%',
                    deepCooperationRate: '0%',

                    industryDistribution: [],
                    scenarioDistribution: [],
                    priorityDistribution: [],
                    deepCooperationEnterprises: [],
                    recentActivities: [],
                    trendData: []
                };
            }
        }

        // Components
        const Sidebar = () => (
            <div className="sidebar fixed inset-y-0 left-0 z-30 w-64 flex flex-col">
                <div className="flex items-center justify-center h-16 border-b-4 border-gray-700">
                    <h1 className="text-white text-xl font-bold">AI技术生态平台</h1>
                </div>
                <nav className="flex-1 px-4 py-6">
                    <ul className="space-y-2">
                        <li>
                            <a href="#" className="flex items-center gap-3 text-white bg-blue-600 px-4 py-3 rounded-lg border-2 border-blue-700">
                                <i className="fas fa-chart-bar"></i>
                                <span>AI生态仪表盘</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" className="flex items-center gap-3 text-gray-300 hover:text-white hover:bg-gray-700 px-4 py-3 rounded-lg border-2 border-gray-600">
                                <i className="fas fa-building"></i>
                                <span>企业管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" className="flex items-center gap-3 text-gray-300 hover:text-white hover:bg-gray-700 px-4 py-3 rounded-lg border-2 border-gray-600">
                                <i className="fas fa-file-import"></i>
                                <span>数据导入</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" className="flex items-center gap-3 text-gray-300 hover:text-white hover:bg-gray-700 px-4 py-3 rounded-lg border-2 border-gray-600">
                                <i className="fas fa-tasks"></i>
                                <span>合作管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" className="flex items-center gap-3 text-gray-300 hover:text-white hover:bg-gray-700 px-4 py-3 rounded-lg border-2 border-gray-600">
                                <i className="fas fa-cog"></i>
                                <span>系统设置</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        );

        const Header = () => (
            <header className="sticky top-0 z-20 bg-white border-b-4 border-gray-300">
                <div className="flex items-center justify-between px-6 py-4">
                    <div className="relative">
                        <i className="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-600 text-lg"></i>
                        <input
                            type="text"
                            placeholder="搜索企业或AI场景..."
                            className="pl-10 pr-4 py-3 rounded-lg border-2 border-gray-400 w-80 text-lg font-medium neubrutal-input"
                        />
                    </div>
                    <div className="flex items-center gap-4">
                        <button className="relative p-3 rounded-lg border-2 border-gray-400 hover:bg-gray-100 text-lg">
                            <i className="fas fa-bell text-gray-600"></i>
                            <span className="absolute top-1 right-1 h-3 w-3 bg-red-500 rounded-full border border-white"></span>
                        </button>
                        <div className="flex items-center gap-2">
                            <div className="h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-lg border-2 border-gray-400">
                                A
                            </div>
                            <span className="font-bold text-lg">分析师</span>
                        </div>
                    </div>
                </div>
            </header>
        );

        const HighlightStatCard = ({ title, value, subtitle, icon, change, color = "blue" }) => {
            const colorClasses = {
                blue: "border-blue-500 shadow-[6px_6px_0_0_#3b82f6]",
                green: "border-green-500 shadow-[6px_6px_0_0_#10b981]",
                purple: "border-purple-500 shadow-[6px_6px_0_0_#8b5cf6]",
                yellow: "border-yellow-500 shadow-[6px_6px_0_0_#f59e0b]"
            };

            return (
                <div className={`bg-white rounded-lg border-4 p-6 ${colorClasses[color]} highlight-card`}>
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-sm font-medium text-gray-600 mb-1">{title}</p>
                            <p className="stat-number">{value}</p>
                            <p className="text-sm text-gray-600">{subtitle}</p>
                        </div>
                        <div className="p-4 rounded-lg bg-gray-100 border-2 border-gray-300">
                            <i className={`fas ${icon} text-2xl`}></i>
                        </div>
                    </div>
                    <p className="text-sm font-bold mt-3">
                        <span className={`inline-flex items-center ${change.startsWith('+') ? 'text-green-600' : 'text-red-600'}`}>
                            <i className={`fas fa-arrow-${change.startsWith('+') ? 'up' : 'down'} mr-1`}></i>
                            {change} vs 上月
                        </span>
                    </p>
                </div>
            );
        };

        const ChartPlaceholder = ({ title, type = "bar", description }) => (
            <div className="bg-white rounded-lg border-4 border-gray-800 p-6 neubrutal-card">
                <div className="flex justify-between items-center mb-4">
                    <h2 className="text-lg font-bold">{title}</h2>
                    <button className="border-2 border-gray-400 px-3 py-1 rounded text-sm font-bold">
                        <i className="fas fa-download mr-1"></i>导出
                    </button>
                </div>
                <div className="chart-placeholder rounded-lg h-64 flex items-center justify-center border-4 border-dashed border-gray-400">
                    <div className="text-center">
                        <i className={`fas ${type === "bar" ? "fa-chart-bar" : type === "pie" ? "fa-chart-pie" : "fa-chart-line"} text-4xl mb-2`}></i>
                        <p className="font-bold">{title}</p>
                        <p className="text-sm text-gray-600">{description}</p>
                    </div>
                </div>
                {type !== "trend" && (
                    <div className="flex justify-center gap-4 mt-4">
                        {type === "bar" ? (
                            <>
                                <div className="flex items-center">
                                    <div className="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                    <span className="text-sm">AI技术</span>
                                </div>
                                <div className="flex items-center">
                                    <div className="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
                                    <span className="text-sm">云计算</span>
                                </div>
                                <div className="flex items-center">
                                    <div className="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                    <span className="text-sm">大数据</span>
                                </div>
                            </>
                        ) : (
                            <>
                                <div className="flex items-center">
                                    <div className="w-3 h-3 bg-red-400 rounded-full mr-2"></div>
                                    <span className="text-sm">探索期</span>
                                </div>
                                <div className="flex items-center">
                                    <div className="w-3 h-3 bg-yellow-400 rounded-full mr-2"></div>
                                    <span className="text-sm">试点期</span>
                                </div>
                                <div className="flex items-center">
                                    <div className="w-3 h-3 bg-blue-400 rounded-full mr-2"></div>
                                    <span className="text-sm">规模化应用</span>
                                </div>
                            </>
                        )}
                    </div>
                )}
            </div>
        );

        const CooperationCard = ({ enterprise }) => (
            <div className="bg-white rounded-lg border-4 p-4 neubrutal-card cooperation-card">
                <div className="flex justify-between items-start mb-2">
                    <h3 className="font-bold text-lg">{enterprise.name}</h3>
                    <span className={`cooperation-level level-${enterprise.cooperationLevel}`}>
                        {enterprise.cooperationLevel === 4 ? '战略伙伴' : 
                         enterprise.cooperationLevel === 3 ? '深度合作' : 
                         enterprise.cooperationLevel === 2 ? '项目合作' : '初步接触'}
                    </span>
                </div>
                
                <div className="space-y-1 text-sm mb-3">
                    <p><span className="font-medium">行业:</span> {enterprise.industry}</p>
                    <p><span className="font-medium">AI场景:</span> {enterprise.aiScenario}</p>
                    <p>
                        <span className="font-medium">AI成熟度:</span> 
                        <span className={`ml-2 ai-maturity maturity-${enterprise.aiMaturity}`}>
                            {enterprise.aiMaturity === 'exploring' ? '探索期' : 
                             enterprise.aiMaturity === 'piloting' ? '试点期' : 
                             enterprise.aiMaturity === 'deploying' ? '部署期' : '规模化应用'}
                        </span>
                    </p>
                </div>
                
                <div className="flex justify-between items-center">
                    <div className="flex items-center">
                        {enterprise.baiduAI && (
                            <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-bold border border-blue-300">
                                百度AI
                            </span>
                        )}
                    </div>
                    <span className={`px-2 py-1 rounded text-xs font-bold ${
                        enterprise.cooperationValue === '高' ? 'bg-green-100 text-green-800 border border-green-300' : 
                        enterprise.cooperationValue === '中' ? 'bg-yellow-100 text-yellow-800 border border-yellow-300' : 
                        'bg-gray-100 text-gray-800 border border-gray-300'
                    }`}>
                        {enterprise.cooperationValue}价值
                    </span>
                </div>
            </div>
        );

        const ActivityItem = ({ activity }) => (
            <div className="flex items-start gap-3 p-3 border-b-2 border-gray-200 last:border-b-0">
                <div 
                    className="w-3 h-3 rounded-full mt-2" 
                    style={{ backgroundColor: activity.color }}
                ></div>
                <div className="flex-1">
                    <div className="flex justify-between">
                        <span className="font-bold text-sm">{activity.type}</span>
                        <span className="text-xs text-gray-500">{activity.time}</span>
                    </div>
                    <p className="text-sm">{activity.title}</p>
                </div>
            </div>
        );

        // Main Dashboard Component
        const AIEcosystemDashboard = () => {
            const [data, setData] = React.useState(null);
            const [loading, setLoading] = React.useState(true);
            
            React.useEffect(() => {
                const loadData = async () => {
                    const result = await fetchAIData();
                    setData(result);
                    setLoading(false);
                };
                
                loadData();
            }, []);

            if (loading) {
                return (
                    <div className="flex items-center justify-center h-full">
                        <div className="text-center">
                            <i className="fas fa-spinner fa-spin text-4xl text-blue-500"></i>
                            <p className="mt-4 text-lg font-medium">正在加载AI生态数据...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="space-y-8">
                    <div>
                        <h1 className="text-3xl font-bold">AI技术生态仪表盘</h1>
                        <p className="text-gray-600">区域AI产业发展态势分析与生态合作监控 - 基于真实数据</p>
                    </div>

                    {/* Stats Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <HighlightStatCard
                            title="AI采用企业"
                            value={data.aiAdopters}
                            subtitle={data.aiAdoptionRate}
                            icon="fa-brain"
                            change={data.monthlyGrowth}
                            color="blue"
                        />
                        <HighlightStatCard
                            title="百度AI覆盖"
                            value={data.baiduAICoverage}
                            subtitle={data.baiduAIUsageRate}
                            icon="fa-microchip"
                            change="+15%"
                            color="purple"
                        />
                        <HighlightStatCard
                            title="深度合作企业"
                            value={data.deepCooperation}
                            subtitle={data.deepCooperationRate}
                            icon="fa-handshake"
                            change="+8%"
                            color="green"
                        />
                        <HighlightStatCard
                            title="高成熟度企业"
                            value={data.priorityDistribution.find(item => item.stage === 'P0')?.count || 0}
                            subtitle={`${data.priorityDistribution.find(item => item.stage === 'P0')?.percentage || 0}%规模化应用`}
                            icon="fa-chart-line"
                            change="+12%"
                            color="yellow"
                        />
                    </div>

                    {/* Distribution Charts */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <ChartPlaceholder 
                            title="行业AI采用分布" 
                            description={`AI企业主要集中在${data.industryDistribution[0].industry}领域`}
                        />
                        <ChartPlaceholder 
                            title="AI应用场景分布" 
                            description={`${data.scenarioDistribution[0].scenario}是最主要的AI应用场景`}
                        />
                    </div>

                    {/* Maturity and Financing Charts */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <ChartPlaceholder 
                            title="AI技术成熟度分布" 
                            type="pie"
                            description="大部分企业仍处于探索和试点阶段"
                        />
                        <ChartPlaceholder 
                            title="企业优先级分布" 
                            description="P0优先级企业为重点合作对象"
                        />
                    </div>

                    {/* Cooperation and Trend Charts */}
                    <div className="grid grid-cols-1 gap-6">
                        <ChartPlaceholder 
                            title="企业增长趋势 (近12个月)" 
                            type="trend"
                            description="AI企业数量呈稳步增长趋势"
                        />
                    </div>

                    {/* Deep Cooperation and Activities */}
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2 bg-white rounded-lg border-4 border-gray-800 p-6 neubrutal-card">
                            <h2 className="text-lg font-bold mb-4">深度合作企业 (P0优先级)</h2>
                            <div className="space-y-4">
                                {data.deepCooperationEnterprises.map(enterprise => (
                                    <CooperationCard key={enterprise.id} enterprise={enterprise} />
                                ))}
                            </div>
                            <button className="mt-4 w-full border-2 border-gray-400 py-2 rounded font-bold hover:bg-gray-100">
                                查看所有合作企业
                            </button>
                        </div>
                        
                        <div className="bg-white rounded-lg border-4 border-gray-800 p-6 neubrutal-card">
                            <h2 className="text-lg font-bold mb-4">最近活动</h2>
                            <div className="space-y-2">
                                {data.recentActivities.map(activity => (
                                    <ActivityItem key={activity.id} activity={activity} />
                                ))}
                            </div>
                            <button className="mt-4 w-full border-2 border-gray-400 py-2 rounded font-bold hover:bg-gray-100">
                                查看全部活动
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            return (
                <div className="flex">
                    <Sidebar />
                    <div className="lg:pl-64 flex flex-col flex-1">
                        <Header />
                        <main className="flex-1 p-6 overflow-y-auto bg-gray-100">
                            <AIEcosystemDashboard />
                        </main>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>